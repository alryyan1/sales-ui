# دليل اختبار نظام المخزون

## جدول المحتويات

1. [مقدمة](#مقدمة)
2. [المفاهيم الأساسية للمخزون](#المفاهيم-الأساسية-للمخزون)
3. [سيناريوهات الاختبار](#سيناريوهات-الاختبار)
4. [قائمة التحقق من الاختبار](#قائمة-التحقق-من-الاختبار)
5. [السيناريوهات المتقدمة](#السيناريوهات-المتقدمة)

---

## مقدمة

### نظرة عامة على نظام المخزون

نظام المخزون في هذا التطبيق يتتبع جميع حركات المخزون بشكل دقيق، بما في ذلك:
- المشتريات (زيادة المخزون)
- المبيعات (نقصان المخزون)
- التعديلات اليدوية للمخزون
- التحويلات بين المستودعات
- طلبات المخزون (الاستصدارات)
- تتبع الدفعات (Batches)
- سجل حركات المخزون

### المتطلبات الأساسية للاختبار

قبل البدء في اختبار نظام المخزون، تأكد من:

1. **الحسابات المطلوبة:**
   - حساب مستخدم بصلاحيات `view-products` لعرض المنتجات
   - حساب مستخدم بصلاحيات `view-purchases` لإدارة المشتريات
   - حساب مستخدم بصلاحيات `view-pos` لإدارة المبيعات
   - حساب مستخدم بصلاحيات `view-stock-adjustments` لإدارة التعديلات
   - حساب مستخدم بصلاحيات `view-stock-transfers` لإدارة التحويلات
   - حساب مستخدم بصلاحيات `request-stock` لطلب المخزون
   - حساب مستخدم بصلاحيات `view-stock-requisitions` لمعالجة الطلبات

2. **البيانات المطلوبة:**
   - منتجات مسجلة في النظام
   - موردون مسجلون
   - عملاء مسجلون
   - مستودعات مسجلة (إذا كان النظام يدعم المستودعات المتعددة)
   - وحدات قياس (وحدات التخزين ووحدات البيع)

3. **المعرفة المطلوبة:**
   - فهم الفرق بين وحدات التخزين (Stocking Units) ووحدات البيع (Sellable Units)
   - فهم نظام الدفعات (Batches)
   - فهم مستويات التنبيه للمخزون

---

## المفاهيم الأساسية للمخزون

### 1. تتبع كمية المخزون

المخزون يتم تتبعه بوحدات البيع (Sellable Units). على سبيل المثال:
- إذا كان المنتج يُباع بالقطعة، فالمخزون يُحسب بالقطع
- إذا كان المنتج يُخزن بالصندوق (12 قطعة)، فالمخزون يُحسب بالقطع وليس بالصناديق

### 2. إدارة الدفعات (Batch Management)

كل عملية شراء تُنشئ دفعة جديدة تحتوي على:
- **رقم الدفعة** (Batch Number): معرف فريد للدفعة
- **الكمية المتبقية** (Remaining Quantity): الكمية المتبقية من هذه الدفعة
- **التكلفة للوحدة** (Unit Cost): تكلفة الوحدة الواحدة
- **تاريخ الانتهاء** (Expiry Date): تاريخ انتهاء الصلاحية (إن وجد)
- **سعر البيع المقترح** (Sale Price): السعر المقترح للبيع

عند البيع، يتم خصم الكمية من دفعة محددة (FIFO - First In First Out).

### 3. وحدات المخزون

**وحدات التخزين (Stocking Units):**
- الوحدة التي يتم شراء المنتج بها (مثل: صندوق، كرتون)
- تُستخدم عند إدخال المشتريات

**وحدات البيع (Sellable Units):**
- الوحدة التي يتم بيع المنتج بها (مثل: قطعة، علبة)
- تُستخدم في المبيعات وتتبع المخزون

**مثال:**
- منتج يُخزن بالصندوق (12 قطعة)
- وحدات التخزين: صندوق
- وحدات البيع: قطعة
- عدد القطع في الصندوق: 12

### 4. إدارة المستودعات

إذا كان النظام يدعم المستودعات المتعددة:
- كل منتج يمكن أن يكون له مخزون في مستودعات مختلفة
- يمكن نقل المخزون بين المستودعات
- كل حركة مخزون مرتبطة بمستودع محدد

### 5. مستويات التنبيه للمخزون

**حد التنبيه (Stock Alert Level):**
- الحد الأدنى للمخزون الذي عند الوصول إليه يتم إظهار تنبيه
- يمكن تعيينه لكل منتج على حدة
- عند انخفاض المخزون إلى هذا الحد أو أقل، يظهر تنبيه

**حالات المخزون:**
- **مخزون كافٍ**: المخزون أعلى من حد التنبيه
- **مخزون منخفض**: المخزون يساوي أو أقل من حد التنبيه
- **نفاد المخزون**: المخزون يساوي صفر

---

## سيناريوهات الاختبار

### القسم أ: المشتريات والمخزون

#### اختبار 1: إنشاء عملية شراء جديدة

**الخطوات:**

1. سجل الدخول بحساب لديه صلاحيات `view-purchases`
2. انتقل إلى **المشتريات** → **قائمة المشتريات**
3. انقر على زر **إضافة مشتريات جديدة** أو **Add Purchase**
4. املأ البيانات التالية:
   - **المورد**: اختر مورداً من القائمة
   - **تاريخ الشراء**: اختر تاريخ الشراء
   - **رقم المرجع**: (اختياري) أدخل رقم مرجعي
   - **الحالة**: اختر "مستلم" (received) أو "معلق" (pending)
   - **العملة**: اختر العملة
   - **ملاحظات**: (اختياري) أدخل أي ملاحظات

5. انقر على **حفظ** أو **Save**

**النتيجة المتوقعة:**
- يتم إنشاء عملية الشراء بنجاح
- يتم عرض رسالة نجاح
- يتم توجيهك إلى صفحة إدارة عناصر الشراء

---

#### اختبار 2: إضافة عناصر إلى عملية الشراء

**الخطوات:**

1. بعد إنشاء عملية الشراء، ستكون في صفحة **إدارة عناصر الشراء**
2. انقر على زر **إضافة عنصر** أو **Add Item**
3. في النافذة المنبثقة، املأ البيانات التالية:
   - **المنتج**: اختر منتجاً من القائمة (استخدم البحث للعثور على المنتج)
   - **رقم الدفعة**: (اختياري) أدخل رقم دفعة إذا كان المنتج له دفعات
   - **الكمية**: أدخل الكمية بوحدات التخزين (مثلاً: عدد الصناديق)
   - **تكلفة الوحدة**: أدخل تكلفة الوحدة الواحدة
   - **سعر البيع**: أدخل السعر المقترح للبيع
   - **تاريخ الانتهاء**: (اختياري) إذا كان المنتج له تاريخ انتهاء صلاحية

4. انقر على **إضافة** أو **Add**

**النتيجة المتوقعة:**
- يتم إضافة العنصر إلى قائمة عناصر الشراء
- يتم تحديث إجمالي المبلغ تلقائياً
- يظهر العنصر في الجدول

---

#### اختبار 3: استلام عملية الشراء والتحقق من زيادة المخزون

**الخطوات:**

1. تأكد من أن حالة عملية الشراء هي **"مستلم"** (received)
   - إذا كانت "معلق"، قم بتغيير الحالة إلى "مستلم"

2. بعد إضافة جميع العناصر، تأكد من حفظ التغييرات

3. انتقل إلى صفحة **المنتجات** → **قائمة المنتجات**

4. ابحث عن المنتج الذي أضفته في عملية الشراء

5. تحقق من:
   - **كمية المخزون**: يجب أن تكون قد زادت بالكمية التي تم شراؤها
   - **أحدث تكلفة**: يجب أن تكون قد تم تحديثها
   - **سعر البيع المقترح**: يجب أن يكون قد تم تحديثه

**النتيجة المتوقعة:**
- كمية المخزون تزيد بنفس الكمية المشتراة (محولة إلى وحدات البيع)
- يتم تحديث تكلفة الوحدة وسعر البيع
- إذا كان المنتج يدعم الدفعات، يجب أن تظهر دفعة جديدة

---

#### اختبار 4: التحقق من إنشاء الدفعات

**الخطوات:**

1. بعد استلام عملية شراء تحتوي على منتج يدعم الدفعات
2. انتقل إلى صفحة **المنتجات** → **قائمة المنتجات**
3. ابحث عن المنتج
4. إذا كان المنتج يدعم عرض الدفعات، انقر على أيقونة التوسيع (Expand)
5. تحقق من:
   - ظهور دفعة جديدة
   - رقم الدفعة (إن وجد)
   - الكمية المتبقية
   - التكلفة للوحدة
   - تاريخ الانتهاء (إن وجد)
   - سعر البيع المقترح

**النتيجة المتوقعة:**
- تظهر دفعة جديدة مع جميع التفاصيل
- الكمية المتبقية تساوي الكمية المشتراة (محولة إلى وحدات البيع)

---

### القسم ب: المبيعات والمخزون

#### اختبار 5: إنشاء عملية بيع

**الخطوات:**

1. سجل الدخول بحساب لديه صلاحيات `view-pos`
2. انتقل إلى **المبيعات** → **نقطة البيع (Online)** أو **نقطة البيع (Offline)**
3. في واجهة نقطة البيع:
   - ابحث عن منتج أو انقر عليه لإضافته إلى السلة
   - إذا كان المنتج له دفعات متعددة، سيظهر مربع حوار لاختيار الدفعة
   - اختر الدفعة المطلوبة (عادةً الأقدم أولاً - FIFO)
   - أدخل الكمية المطلوبة
   - كرر العملية لإضافة منتجات أخرى

4. (اختياري) اختر عميلاً من القائمة
5. (اختياري) أضف خصماً إذا لزم الأمر
6. انقر على **إتمام البيع** أو **Complete Sale**

**النتيجة المتوقعة:**
- يتم إنشاء عملية البيع بنجاح
- يتم خصم الكمية من المخزون
- يتم خصم الكمية من الدفعة المحددة

---

#### اختبار 6: التحقق من نقصان المخزون بعد البيع

**الخطوات:**

1. قبل إنشاء عملية البيع، سجل كمية المخزون الحالية لمنتج معين
2. قم بإنشاء عملية بيع تحتوي على هذا المنتج
3. بعد إتمام البيع، انتقل إلى **المنتجات** → **قائمة المنتجات**
4. ابحث عن المنتج
5. تحقق من:
   - **كمية المخزون**: يجب أن تكون قد نقصت بنفس الكمية المباعة
   - **الكمية المتبقية في الدفعة**: يجب أن تكون قد نقصت

**النتيجة المتوقعة:**
- كمية المخزون تنقص بنفس الكمية المباعة
- الكمية المتبقية في الدفعة المحددة تنقص
- إذا نفدت الدفعة بالكامل، يجب أن تختفي من قائمة الدفعات المتاحة

---

#### اختبار 7: اختيار الدفعة عند البيع

**الخطوات:**

1. في نقطة البيع، أضف منتجاً له دفعات متعددة
2. عند ظهور مربع حوار اختيار الدفعة:
   - راجع قائمة الدفعات المتاحة
   - تحقق من الكميات المتبقية لكل دفعة
   - تحقق من تواريخ الانتهاء (إن وجدت)
   - اختر الدفعة المطلوبة

3. أكمل عملية البيع

**النتيجة المتوقعة:**
- يتم خصم الكمية من الدفعة المحددة فقط
- الدفعات الأخرى تبقى كما هي
- يتم تتبع الدفعة المستخدمة في عملية البيع

---

### القسم ج: التعديلات اليدوية للمخزون

#### اختبار 8: إنشاء تعديل مخزني (زيادة)

**الخطوات:**

1. سجل الدخول بحساب لديه صلاحيات `view-stock-adjustments`
2. انتقل إلى **المخزون** → **تعديلات المخزون**
3. انقر على زر **إضافة تعديل** أو **Add Adjustment**
4. املأ البيانات التالية:
   - **المنتج**: اختر منتجاً
   - **المستودع**: (إذا كان النظام يدعم المستودعات) اختر المستودع
   - **نوع التعديل**: اختر "زيادة" (Increase)
   - **الكمية**: أدخل الكمية المراد إضافتها
   - **السبب**: اختر سبب التعديل (تلف، انتهاء صلاحية، سرقة، فقدان، تعديل، تصحيح، أخرى)
   - **ملاحظات**: (اختياري) أدخل ملاحظات إضافية

5. انقر على **حفظ** أو **Save**

**النتيجة المتوقعة:**
- يتم إنشاء التعديل بنجاح
- كمية المخزون تزيد بالكمية المحددة
- يظهر التعديل في سجل التعديلات

---

#### اختبار 9: إنشاء تعديل مخزني (نقصان)

**الخطوات:**

1. اتبع نفس الخطوات في اختبار 8
2. عند اختيار نوع التعديل، اختر **"نقصان"** (Decrease)
3. أدخل الكمية المراد خصمها
4. اختر السبب المناسب (مثل: تلف، انتهاء صلاحية)

**النتيجة المتوقعة:**
- يتم إنشاء التعديل بنجاح
- كمية المخزون تنقص بالكمية المحددة
- يظهر التعديل في سجل التعديلات

---

#### اختبار 10: عرض سجل التعديلات

**الخطوات:**

1. انتقل إلى **المخزون** → **تعديلات المخزون**
2. راجع قائمة التعديلات:
   - التاريخ
   - المنتج
   - نوع التعديل (زيادة/نقصان)
   - الكمية
   - السبب
   - المستخدم
   - المستودع (إن وجد)

3. استخدم الفلاتر للبحث:
   - حسب التاريخ
   - حسب المنتج
   - حسب المستودع
   - حسب نوع التعديل

**النتيجة المتوقعة:**
- تظهر جميع التعديلات في جدول منظم
- يمكن تصفية النتائج حسب المعايير المختلفة
- يمكن التنقل بين الصفحات إذا كانت هناك نتائج كثيرة

---

### القسم د: تحويلات المخزون

#### اختبار 11: إنشاء تحويل مخزني

**الخطوات:**

1. سجل الدخول بحساب لديه صلاحيات `view-stock-transfers`
2. انتقل إلى **المخزون** → **تحويلات المخزون**
3. انقر على زر **إضافة تحويل** أو **Create Transfer**
4. املأ البيانات التالية:
   - **المنتج**: اختر منتجاً
   - **من المستودع**: اختر المستودع المصدر
   - **إلى المستودع**: اختر المستودع الوجهة
   - **الكمية**: أدخل الكمية المراد تحويلها
   - **ملاحظات**: (اختياري) أدخل ملاحظات

5. انقر على **حفظ** أو **Save**

**النتيجة المتوقعة:**
- يتم إنشاء التحويل بنجاح
- كمية المخزون في المستودع المصدر تنقص
- كمية المخزون في المستودع الوجهة تزيد
- يظهر التحويل في سجل التحويلات

---

#### اختبار 12: التحقق من تأثير التحويل على المستودعات

**الخطوات:**

1. قبل إنشاء التحويل:
   - سجل كمية المخزون في المستودع المصدر
   - سجل كمية المخزون في المستودع الوجهة

2. قم بإنشاء تحويل مخزني

3. بعد إنشاء التحويل:
   - انتقل إلى **الإدارة** → **المستودعات** → اختر المستودع المصدر
   - تحقق من نقصان كمية المخزون
   - انتقل إلى المستودع الوجهة
   - تحقق من زيادة كمية المخزون

**النتيجة المتوقعة:**
- المستودع المصدر: تنقص الكمية بنفس الكمية المحولة
- المستودع الوجهة: تزيد الكمية بنفس الكمية المحولة
- إجمالي المخزون في النظام يبقى كما هو

---

#### اختبار 13: عرض سجل التحويلات

**الخطوات:**

1. انتقل إلى **المخزون** → **تحويلات المخزون**
2. راجع قائمة التحويلات:
   - التاريخ
   - المنتج
   - من المستودع
   - إلى المستودع
   - الكمية
   - المستخدم

**النتيجة المتوقعة:**
- تظهر جميع التحويلات في جدول منظم
- يمكن رؤية تفاصيل كل تحويل
- يمكن تصفية النتائج حسب التاريخ أو المنتج

---

### القسم هـ: طلبات المخزون (الاستصدارات)

#### اختبار 14: طلب مخزون (من قبل المستخدم)

**الخطوات:**

1. سجل الدخول بحساب لديه صلاحيات `request-stock`
2. انتقل إلى **الإدارة** → **طلب مخزون** أو **Inventory** → **Request Stock**
3. انقر على زر **طلب جديد** أو **New Request**
4. املأ البيانات التالية:
   - **القسم/السبب**: أدخل القسم أو سبب الطلب
   - **تاريخ الطلب**: اختر تاريخ الطلب
   - **ملاحظات**: (اختياري) أدخل ملاحظات عامة

5. أضف العناصر المطلوبة:
   - انقر على **إضافة عنصر** أو **Add Item**
   - اختر المنتج
   - أدخل الكمية المطلوبة
   - (اختياري) أدخل ملاحظات للعنصر

6. كرر الخطوة 5 لإضافة عناصر أخرى

7. انقر على **إرسال الطلب** أو **Submit Request**

**النتيجة المتوقعة:**
- يتم إنشاء طلب المخزون بنجاح
- يظهر الطلب في قائمة الطلبات بحالة "معلق" (pending)
- يمكن للمدير رؤية الطلب ومعالجته

---

#### اختبار 15: عرض طلبات المخزون (من قبل المدير)

**الخطوات:**

1. سجل الدخول بحساب لديه صلاحيات `view-stock-requisitions`
2. انتقل إلى **الإدارة** → **طلبات المخزون** أو **Inventory** → **Stock Requisitions**
3. راجع قائمة الطلبات:
   - رقم الطلب
   - القسم/السبب
   - تاريخ الطلب
   - الحالة (معلق، معتمد، مرفوض، مصدر جزئياً، مصدر)
   - الطالب
   - عدد العناصر

4. استخدم الفلاتر للبحث:
   - حسب الحالة
   - حسب التاريخ
   - حسب الطالب
   - حسب البحث النصي

**النتيجة المتوقعة:**
- تظهر جميع الطلبات في جدول منظم
- يمكن تصفية النتائج حسب المعايير المختلفة
- يمكن رؤية تفاصيل كل طلب

---

#### اختبار 16: معالجة طلب مخزون (إصدار كامل)

**الخطوات:**

1. انتقل إلى **الإدارة** → **طلبات المخزون**
2. ابحث عن طلب بحالة "معلق" (pending)
3. انقر على زر **معالجة** أو **Process**
4. في صفحة المعالجة:
   - راجع معلومات الطلب (القسم، التاريخ، الملاحظات)
   - راجع قائمة العناصر المطلوبة

5. لكل عنصر:
   - راجع الكمية المطلوبة
   - أدخل الكمية المراد إصدارها (يمكن أن تكون أقل من المطلوب)
   - إذا كان المنتج له دفعات، اختر الدفعة المراد الإصدار منها:
     - انقر على زر اختيار الدفعة
     - اختر الدفعة من القائمة
     - تحقق من الكمية المتاحة في الدفعة
   - (اختياري) أدخل ملاحظات للعنصر

6. في نهاية الصفحة:
   - اختر الحالة النهائية: "معتمد" (approved) أو "مصدر" (issued)
   - (اختياري) أدخل ملاحظات عامة

7. انقر على **حفظ** أو **Save**

**النتيجة المتوقعة:**
- يتم تحديث حالة الطلب
- يتم خصم الكمية من المخزون
- يتم خصم الكمية من الدفعة المحددة
- يظهر الطلب في السجل بحالة محدثة

---

#### اختبار 17: معالجة طلب مخزون (إصدار جزئي)

**الخطوات:**

1. اتبع نفس الخطوات في اختبار 16
2. عند إدخال الكميات، أدخل كميات أقل من المطلوب لبعض العناصر
3. اختر الحالة النهائية: **"مصدر جزئياً"** (partially_issued)

**النتيجة المتوقعة:**
- يتم تحديث حالة الطلب إلى "مصدر جزئياً"
- يتم خصم الكميات المصدرة فقط
- يمكن معالجة الطلب مرة أخرى لإصدار الكميات المتبقية

---

#### اختبار 18: رفض طلب مخزون

**الخطوات:**

1. في صفحة معالجة الطلب
2. اختر الحالة النهائية: **"مرفوض"** (rejected)
3. أدخل ملاحظات توضح سبب الرفض
4. انقر على **حفظ**

**النتيجة المتوقعة:**
- يتم تحديث حالة الطلب إلى "مرفوض"
- لا يتم خصم أي كميات من المخزون
- يظهر الطلب في السجل بحالة "مرفوض"

---

### القسم و: سجل المخزون

#### اختبار 19: عرض سجل حركات المخزون

**الخطوات:**

1. سجل الدخول بحساب لديه صلاحيات `view-reports-inventory-log`
2. انتقل إلى **التقارير** → **سجل المخزون** أو **Reports** → **Inventory Log**
3. راجع قائمة حركات المخزون:
   - التاريخ والوقت
   - نوع الحركة (شراء، بيع، تعديل، صرف مخزني)
   - المنتج
   - الكمية (+/-)
   - المستودع
   - المستخدم
   - المرجع (رقم العملية)

**النتيجة المتوقعة:**
- تظهر جميع حركات المخزون في جدول منظم
- كل حركة تُظهر نوعها وكميتها
- يمكن رؤية تفاصيل كل حركة

---

#### اختبار 20: تصفية سجل المخزون حسب التاريخ

**الخطوات:**

1. في صفحة سجل المخزون
2. استخدم فلاتر التاريخ:
   - **تاريخ البداية**: اختر تاريخ البداية
   - **تاريخ النهاية**: اختر تاريخ النهاية
3. انقر على **تطبيق الفلاتر** أو **Apply Filters**

**النتيجة المتوقعة:**
- تظهر فقط الحركات في الفترة المحددة
- يمكن رؤية جميع أنواع الحركات في هذه الفترة

---

#### اختبار 21: تصفية سجل المخزون حسب المنتج

**الخطوات:**

1. في صفحة سجل المخزون
2. استخدم فلتر المنتج:
   - ابحث عن المنتج أو اختره من القائمة
3. انقر على **تطبيق الفلاتر**

**النتيجة المتوقعة:**
- تظهر فقط حركات المنتج المحدد
- يمكن رؤية جميع أنواع الحركات لهذا المنتج

---

#### اختبار 22: تصفية سجل المخزون حسب نوع الحركة

**الخطوات:**

1. في صفحة سجل المخزون
2. استخدم فلتر نوع الحركة:
   - اختر نوع الحركة (شراء، بيع، تعديل مخزني، صرف مخزني)
3. انقر على **تطبيق الفلاتر**

**النتيجة المتوقعة:**
- تظهر فقط الحركات من النوع المحدد
- يمكن رؤية جميع المنتجات لهذا النوع من الحركات

---

#### اختبار 23: تصدير سجل المخزون

**الخطوات:**

1. في صفحة سجل المخزون
2. طبق الفلاتر المطلوبة (إن وجدت)
3. انقر على زر **تصدير PDF** أو **Export PDF**

**النتيجة المتوقعة:**
- يتم إنشاء ملف PDF يحتوي على سجل المخزون
- يفتح الملف في نافذة جديدة
- يمكن حفظ الملف أو طباعته

---

### القسم ز: إدارة مخزون المنتجات

#### اختبار 24: عرض مستويات المخزون

**الخطوات:**

1. انتقل إلى **المنتجات** → **قائمة المنتجات**
2. راجع الجدول:
   - اسم المنتج
   - كمية المخزون
   - حد التنبيه
   - حالة المخزون (كافٍ، منخفض، نفد)

**النتيجة المتوقعة:**
- تظهر جميع المنتجات مع مستويات مخزونها
- المنتجات منخفضة المخزون تظهر بلون مميز
- المنتجات نافدة المخزون تظهر بلون أحمر

---

#### اختبار 25: تعيين حد التنبيه للمخزون

**الخطوات:**

1. في صفحة قائمة المنتجات
2. انقر على منتج لتحريره
3. في نموذج التحرير:
   - ابحث عن حقل **حد التنبيه** (Stock Alert Level)
   - أدخل القيمة المطلوبة (مثلاً: 10)
4. انقر على **حفظ**

**النتيجة المتوقعة:**
- يتم حفظ حد التنبيه
- عند انخفاض المخزون إلى هذا الحد أو أقل، سيظهر تنبيه
- يظهر حد التنبيه في قائمة المنتجات

---

#### اختبار 26: تصفية المنتجات حسب حالة المخزون

**الخطوات:**

1. في صفحة قائمة المنتجات
2. استخدم الفلاتر:
   - **عرض المنتجات منخفضة المخزون فقط**: فعّل هذا الخيار
   - أو **عرض المنتجات نافدة المخزون فقط**: فعّل هذا الخيار
3. انقر على **تطبيق الفلاتر**

**النتيجة المتوقعة:**
- تظهر فقط المنتجات التي تطابق الفلتر
- يمكن رؤية جميع المنتجات التي تحتاج إلى إعادة توريد

---

#### اختبار 27: عرض تفاصيل الدفعات للمنتج

**الخطوات:**

1. في صفحة قائمة المنتجات
2. ابحث عن منتج يدعم الدفعات
3. إذا كان الجدول يدعم التوسيع، انقر على أيقونة التوسيع بجانب المنتج
4. راجع تفاصيل الدفعات:
   - رقم الدفعة
   - الكمية المتبقية
   - تاريخ الانتهاء
   - التكلفة للوحدة
   - سعر البيع المقترح

**النتيجة المتوقعة:**
- تظهر جميع الدفعات المتاحة للمنتج
- يمكن رؤية تفاصيل كل دفعة
- يمكن معرفة أي دفعة ستنتهي صلاحيتها قريباً

---

## قائمة التحقق من الاختبار

### قائمة التحقق الشاملة

استخدم هذه القائمة للتأكد من اختبار جميع الميزات:

#### المشتريات
- [ ] إنشاء عملية شراء جديدة
- [ ] إضافة عناصر إلى عملية الشراء
- [ ] استلام عملية الشراء
- [ ] التحقق من زيادة المخزون بعد الشراء
- [ ] التحقق من إنشاء الدفعات
- [ ] التحقق من تحديث التكلفة وسعر البيع

#### المبيعات
- [ ] إنشاء عملية بيع
- [ ] اختيار الدفعة عند البيع
- [ ] التحقق من نقصان المخزون بعد البيع
- [ ] التحقق من نقصان الكمية في الدفعة
- [ ] بيع منتج له دفعات متعددة

#### التعديلات اليدوية
- [ ] إنشاء تعديل زيادة
- [ ] إنشاء تعديل نقصان
- [ ] التحقق من تأثير التعديل على المخزون
- [ ] عرض سجل التعديلات
- [ ] تصفية التعديلات حسب المعايير المختلفة

#### التحويلات
- [ ] إنشاء تحويل مخزني
- [ ] التحقق من نقصان المخزون في المستودع المصدر
- [ ] التحقق من زيادة المخزون في المستودع الوجهة
- [ ] عرض سجل التحويلات

#### طلبات المخزون
- [ ] طلب مخزون (من قبل المستخدم)
- [ ] عرض طلبات المخزون (من قبل المدير)
- [ ] معالجة طلب وإصدار كامل
- [ ] معالجة طلب وإصدار جزئي
- [ ] رفض طلب مخزون
- [ ] اختيار الدفعة عند الإصدار

#### سجل المخزون
- [ ] عرض سجل المخزون
- [ ] تصفية حسب التاريخ
- [ ] تصفية حسب المنتج
- [ ] تصفية حسب نوع الحركة
- [ ] تصدير السجل إلى PDF

#### إدارة المنتجات
- [ ] عرض مستويات المخزون
- [ ] تعيين حد التنبيه
- [ ] تصفية المنتجات حسب حالة المخزون
- [ ] عرض تفاصيل الدفعات

---

## السيناريوهات المتقدمة

### السيناريو 1: تتبع دورة حياة دفعة كاملة

**الهدف:** تتبع دفعة من الشراء حتى البيع الكامل

**الخطوات:**

1. **الشراء:**
   - أنشئ عملية شراء لمنتج معين
   - أدخل كمية (مثلاً: 100 قطعة)
   - أدخل رقم دفعة (مثلاً: BATCH-001)
   - استلم عملية الشراء

2. **التحقق:**
   - تحقق من ظهور الدفعة في المنتج
   - تحقق من أن الكمية المتبقية = 100

3. **البيع الجزئي:**
   - أنشئ عملية بيع
   - اختر نفس المنتج والدفعة
   - بيع 30 قطعة

4. **التحقق:**
   - تحقق من أن الكمية المتبقية = 70
   - تحقق من ظهور الحركة في سجل المخزون

5. **البيع الكامل:**
   - أنشئ عملية بيع أخرى
   - بيع 70 قطعة المتبقية

6. **التحقق النهائي:**
   - تحقق من أن الكمية المتبقية = 0
   - تحقق من اختفاء الدفعة من قائمة الدفعات المتاحة
   - تحقق من ظهور جميع الحركات في سجل المخزون

**النتيجة المتوقعة:**
- يتم تتبع الدفعة بدقة من البداية حتى النهاية
- جميع الحركات مسجلة في سجل المخزون
- المخزون دقيق في كل مرحلة

---

### السيناريو 2: إدارة المخزون متعدد المستودعات

**الهدف:** اختبار نقل المخزون بين المستودعات

**الخطوات:**

1. **الإعداد:**
   - تأكد من وجود مستودعين على الأقل
   - تأكد من وجود منتج في المستودع الأول

2. **التحقق الأولي:**
   - سجل كمية المخزون في المستودع الأول
   - سجل كمية المخزون في المستودع الثاني

3. **التحويل:**
   - أنشئ تحويل مخزني
   - انقل كمية من المستودع الأول إلى الثاني

4. **التحقق:**
   - تحقق من نقصان الكمية في المستودع الأول
   - تحقق من زيادة الكمية في المستودع الثاني
   - تحقق من أن إجمالي المخزون لم يتغير

5. **البيع من المستودع الثاني:**
   - أنشئ عملية بيع
   - تأكد من أن البيع يتم من المستودع الثاني
   - تحقق من نقصان المخزون في المستودع الثاني فقط

**النتيجة المتوقعة:**
- يتم تتبع المخزون بشكل منفصل لكل مستودع
- التحويلات تعمل بشكل صحيح
- المبيعات تؤثر على المستودع الصحيح فقط

---

### السيناريو 3: معالجة طلب مخزون معقد

**الهدف:** اختبار معالجة طلب يحتوي على عدة عناصر ودفعات مختلفة

**الخطوات:**

1. **إنشاء الطلب:**
   - أنشئ طلب مخزون يحتوي على 3 منتجات مختلفة
   - كل منتج له دفعات متعددة

2. **المعالجة:**
   - افتح صفحة المعالجة
   - لكل منتج:
     - اختر دفعة مختلفة
     - أصدر كميات مختلفة (بعضها كامل، بعضها جزئي)
   - احفظ المعالجة

3. **التحقق:**
   - تحقق من تحديث حالة الطلب
   - تحقق من نقصان المخزون لكل منتج
   - تحقق من نقصان الكميات في الدفعات المحددة
   - تحقق من ظهور جميع الحركات في سجل المخزون

**النتيجة المتوقعة:**
- يتم معالجة جميع العناصر بشكل صحيح
- يتم تتبع الدفعات المستخدمة
- جميع الحركات مسجلة بدقة

---

### السيناريو 4: تتبع المنتجات منخفضة المخزون

**الهدف:** اختبار نظام التنبيهات للمخزون المنخفض

**الخطوات:**

1. **الإعداد:**
   - حدد منتجاً وضبط حد التنبيه (مثلاً: 20)
   - تأكد من أن المخزون الحالي أعلى من الحد

2. **تقليل المخزون:**
   - قم بعمليات بيع أو تعديلات لتقليل المخزون
   - قلل المخزون إلى ما دون حد التنبيه

3. **التحقق:**
   - انتقل إلى قائمة المنتجات
   - تحقق من ظهور المنتج كمنتج منخفض المخزون
   - استخدم فلتر "عرض المنتجات منخفضة المخزون فقط"
   - تحقق من ظهور المنتج في النتائج

4. **نفاد المخزون:**
   - قلل المخزون إلى صفر
   - تحقق من ظهور المنتج كمنتج نافد المخزون

**النتيجة المتوقعة:**
- يتم تحديث حالة المخزون تلقائياً
- المنتجات منخفضة المخزون تظهر بوضوح
- يمكن تصفية المنتجات حسب الحالة

---

### السيناريو 5: اختبار التكامل الكامل

**الهدف:** اختبار سيناريو كامل يضم جميع العمليات

**الخطوات:**

1. **الشراء:**
   - أنشئ عملية شراء لمنتج جديد
   - أضف 3 منتجات مختلفة بكميات مختلفة
   - استلم عملية الشراء

2. **التحقق من المخزون:**
   - تحقق من زيادة مخزون جميع المنتجات
   - تحقق من ظهور الدفعات

3. **البيع:**
   - أنشئ عملية بيع
   - أضف المنتجات الثلاثة
   - اختر دفعات مختلفة لكل منتج
   - أكمل عملية البيع

4. **التحقق من المخزون:**
   - تحقق من نقصان المخزون
   - تحقق من نقصان الكميات في الدفعات

5. **التعديل:**
   - أنشئ تعديل مخزني لزيادة كمية أحد المنتجات

6. **التحويل:**
   - إذا كان النظام يدعم المستودعات، أنشئ تحويل مخزني

7. **الطلب:**
   - أنشئ طلب مخزون
   - عالج الطلب وأصدر المخزون

8. **التحقق النهائي:**
   - راجع سجل المخزون
   - تحقق من ظهور جميع الحركات
   - تحقق من دقة المخزون النهائي

**النتيجة المتوقعة:**
- جميع العمليات تعمل بشكل متكامل
- المخزون دقيق في كل مرحلة
- جميع الحركات مسجلة بشكل صحيح

---

## نصائح استكشاف الأخطاء

### المشاكل الشائعة وحلولها

#### المشكلة 1: المخزون لا يتحدث بعد الشراء

**الأسباب المحتملة:**
- حالة عملية الشراء ليست "مستلم"
- لم يتم حفظ التغييرات

**الحل:**
1. تحقق من حالة عملية الشراء
2. تأكد من تغيير الحالة إلى "مستلم"
3. احفظ التغييرات
4. انتظر بضع ثوانٍ ثم تحقق من المخزون مرة أخرى

---

#### المشكلة 2: لا يمكن اختيار دفعة عند البيع

**الأسباب المحتملة:**
- المنتج لا يدعم الدفعات
- جميع الدفعات نافدة

**الحل:**
1. تحقق من أن المنتج يدعم الدفعات
2. تحقق من وجود دفعات متاحة
3. إذا نفدت جميع الدفعات، قم بشراء المزيد

---

#### المشكلة 3: لا يمكن إصدار المخزون في طلب

**الأسباب المحتملة:**
- المخزون غير كافٍ
- لم يتم اختيار دفعة
- الكمية المطلوبة أكبر من المتاح

**الحل:**
1. تحقق من كمية المخزون المتاحة
2. تأكد من اختيار دفعة
3. تأكد من أن الكمية المصدرة لا تتجاوز المتاح

---

#### المشكلة 4: سجل المخزون لا يظهر جميع الحركات

**الأسباب المحتملة:**
- الفلاتر المطبقة تقيد النتائج
- التاريخ المحدد لا يشمل الحركات

**الحل:**
1. امسح جميع الفلاتر
2. وسع نطاق التاريخ
3. تحقق من الصفحات الأخرى في الجدول

---

## الخلاصة

هذا الدليل يغطي جميع جوانب اختبار نظام المخزون. تأكد من:

1. **اختبار كل سيناريو** بشكل كامل قبل الانتقال إلى التالي
2. **التحقق من النتائج** في كل خطوة
3. **توثيق أي مشاكل** تواجهها
4. **اختبار السيناريوهات المتقدمة** للتأكد من التكامل الكامل

### نقاط مهمة للتذكر:

- **المخزون يُحسب بوحدات البيع** وليس وحدات التخزين
- **الدفعات تُستخدم تلقائياً** عند البيع (FIFO)
- **جميع الحركات مسجلة** في سجل المخزون
- **المستودعات منفصلة** إذا كان النظام يدعمها
- **حد التنبيه** يساعد في إدارة المخزون

### للدعم والمساعدة:

إذا واجهت أي مشاكل أو لديك أسئلة:
1. راجع قسم "نصائح استكشاف الأخطاء"
2. تحقق من الصلاحيات المطلوبة
3. تأكد من اتباع الخطوات بدقة
4. راجع سجل المخزون للتحقق من الحركات

---

**تاريخ الإنشاء:** 2025  
**الإصدار:** 1.0  
**آخر تحديث:** 2025

